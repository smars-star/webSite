<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>摄像头拍照和获取经纬度</title>
 
</head>
<body>
<div id="container">

    <video id="gum-local" autoplay playsinline></video>
    <button id="showVideo">Open camera</button>

    <div id="errorMsg"></div>

</div>
  
  <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
  <script>
    // Put variables in global scope to make them available to the browser console.
	const constraints = window.constraints = {
	  audio: false,
	  video: true
	};

	function handleSuccess(stream) {
	  const video = document.querySelector('video');
	  const videoTracks = stream.getVideoTracks();
	  console.log('Got stream with constraints:', constraints);
	  console.log(`Using video device: ${videoTracks[0].label}`);
	  window.stream = stream; // make variable available to browser console
	  video.srcObject = stream;
	}

	function handleError(error) {
	  if (error.name === 'ConstraintNotSatisfiedError') {
		let v = constraints.video;
		errorMsg(`The resolution ${v.width.exact}x${v.height.exact} px is not supported by your device.`);
	  } else if (error.name === 'PermissionDeniedError') {
		errorMsg('Permissions have not been granted to use your camera and ' +
		  'microphone, you need to allow the page access to your devices in ' +
		  'order for the demo to work.');
	  }
	  errorMsg(`getUserMedia error: ${error.name}`, error);
	}

	function errorMsg(msg, error) {
	  const errorElement = document.querySelector('#errorMsg');
	  errorElement.innerHTML += `<p>${msg}</p>`;
	  if (typeof error !== 'undefined') {
		console.error(error);
	  }
	}

	async function init(e) {
	  try {
		const stream = await navigator.mediaDevices.getUserMedia(constraints);
		handleSuccess(stream);
		e.target.disabled = true;
	  } catch (e) {
		handleError(e);
	  }
	}

	document.querySelector('#showVideo').addEventListener('click', e => init(e));
  </script>


</body>
</html>
